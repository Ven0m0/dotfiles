id: bash-modern-tools
language: bash
severity: hint
message: Consider modern alternative (if installed)
note: 'fd→find (10-100x), rg→grep (10-100x), sd→sed, jaq→jq, zstd→xz, aria2c→curl/wget'
rule:
  kind: command
  any:
    - pattern: find $$$ARGS -name $PATTERN
    - pattern: grep -r $$$
    - pattern: grep -R $$$
    - pattern: sed -i $$$
    - pattern: jq $$$
    - pattern: xz -$$$
    - pattern: unxz $$$
    - pattern: wget $URL
    - pattern: curl -O $URL
---
id: bash-literal-search
language: bash
severity: hint
message: Use -F for literal search (faster, avoids regex engine)
note: 'grep -F "literal" or rg -F "literal"'
rule:
  kind: command
  any:
    - pattern: grep "$PATTERN" $$$
    - pattern: rg "$PATTERN" $$$
  not:
    has:
      regex: '\s-[EFPGo]'
---
id: bash-parallel-jobs
language: bash
severity: hint
message: Consider parallelizing independent tasks
note: 'task1 & task2 & task3 & wait; or use GNU parallel'
rule:
  kind: list
  pattern: |
    $CMD1
    $CMD2
    $CMD3
  not:
    has:
      kind: background_command
---
id: bash-case-optimize
language: bash
severity: hint
message: Consider if-else for 2-branch case or inline trivial case
note: 'Case shines with 4+ branches or complex patterns'
rule:
  kind: case_statement
  any:
    - pattern: |
        case $VAR in
          $PATTERN) $CMD ;;
        esac
      not:
        has:
          kind: case_item
          regex: '[\*\?\[]'
      not:
        inside:
          any:
            - kind: for_statement
            - kind: while_statement
    - pattern: |
        case $VAR in
          $PATTERN1) $CMD1 ;;
          *) $CMD2 ;;
        esac
      not:
        has:
          kind: case_item
          regex: '^-[a-zA-Z]|--[a-z]'
      not:
        inside:
          kind: while_statement
fix: |
  [[ $VAR == $PATTERN ]] && $CMD
  if [[ $VAR == $PATTERN1 ]]; then $CMD1; else $CMD2; fi
